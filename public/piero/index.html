<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>To Do App</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
  </head>

  <body class="bg-blue-200 flex justify-center items-center h-screen">

    <div class="bg-white rounded-lg shadow-lg p-10">
      <a class="text-gray-400" href="/">Back</a>
      <h1 class="block text-sm font-medium leading-6 text-gray-900">To-Do App</h1>
<<<<<<< HEAD
      <form class="flex justify-center" id="taskForm">

        <label>Name</label>
        <input class="block text-sm font-semibold leading-6 text-gray-900" id="nameInput" type="text" name="name" />
        <button
          class="mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto">Add</button>
        <button class="bg-red-600 text-white text-xs m-2 p-2 rounded hover:bg-red-500" x-show="hasDone" id="clearButton"
          type="button" @click="clearDoneTasks">Clear</button>
=======
      <form id="taskForm" @submit.prevent="createTask" class="flex justify-center">
        <label for="nameInput"></label>
        <input id="nameInput" x-model="taskName" type="text" name="taskName "
          class="bg bg-slate-50 border-none shadow-xl rounded-full mr-4" placeholder="Enter task" />
        <button id="addButton" type="button" class="rounded-full bg-purple-600 text-white px-4 py-2">Add</button>
        <button x-show="hasDoneTasks" id="clearButton" type="button" @click="clearDoneTasks"
          class="rounded-full bg-orange-400 text-white px-4 py-2 ">Clear
          All</button>
>>>>>>> c8d38012bb588121bc50bd9602ea1027edcb8d29
      </form>
      <template x-for="task in tasks" :key="task.id">
        <li>
          <div>
            <input type="checkbox" @change="updateTaskStatus(task)" :checked="task.done" />
            <span x-text="task.name">Name of the task</span>
            <button class="hidden group-hover:block" @click="deleteTask(task)">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="purple"
                class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />
              </svg>
            </button>
          </div>
        </li>
      </template>
    </div>

<<<<<<< HEAD
      <table class="mt-4 mx-auto text-center" id="taskTable">
        <thead class="border-b font-medium dark:border-neutral-500">
          <tr>
            <th scope="col" class="px-6 py-4">ID</th>
            <th scope="col" class="px-6 py-4">Name</th>
            <th scope="col" class="px-6 py-4">Done</th>
            <th scope="col" class="px-6 py-4">Actions</th>
          </tr>
        </thead>
        <tbody id="taskTableBody"></tbody>
      </table>

      <script>
        async function fetchAllTasks() {
          const response = await fetch("/api/piero/tasks");
          const tasks = await response.json();
          console.log("Number of tasks found: ", tasks.length);
          return tasks;
        }

        function renderRow(tableBodyElement, task) {
          console.log("Task: ", task);
          const row = document.createElement("tr");
          tableBodyElement.append(row);

          // Create the ID column
          const idCol = document.createElement("td");
          idCol.append(task.id);
          row.append(idCol);

          // Create the Name column
          const nameCol = document.createElement("td");
          nameCol.append(task.name);
          row.append(nameCol);

          // Create the Done column
          const doneCol = document.createElement("td");
          const checkbox = document.createElement("input");
          checkbox.setAttribute("type", "checkbox");
          if (task.done) {
            checkbox.setAttribute("checked", "");
          }
          doneCol.append(checkbox);
          row.append(doneCol);
          // Create the actions
          const actionCol = document.createElement("td");
          const removeButton = document.createElement("button");
          removeButton.append("remove");
          actionCol.append(removeButton);
          removeButton.addEventListener("click", async function () {
            const choice = window.confirm(`Are you sure you want to delete:\n${task.name}`);
            if (!choice) {
=======
    <script>
      window.todoApp = function () {
        return {
          // This is called when the component is built
          async init() {
            const response = await fetch("/api/piero/tasks");
            this.tasks = await response.json();
            this.hasDone = this.tasks.filter(t => t.done).length > 0;
          },
          // Data
          tasks: [],
          taskName: null,
          hasDone: false,
          // Computed
          get hasDoneTasks() {
            return this.tasks.filter(i => i.done).length > 0;
          },
          // Some of my actions (behavior)
          async createTask() {
            event.preventDefault();
            const nameInput = document.getElementById("nameInput");
            const name = nameInput.value;
            const response = await fetch("/api/piero/tasks", {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({
                name: this.taskName
              })
            });
            const task = await response.json();
            this.tasks.push(task);
            this.taskName = null;
          },
          async clearDoneTasks() {
            if (!confirm('Are you sure?')) {
>>>>>>> c8d38012bb588121bc50bd9602ea1027edcb8d29
              return;
            }

            const tasksToDelete = this.tasks.filter(t => t.done);
            for (const task of tasksToDelete) {
              await this.deleteTask(task, true);
            }
          },
          async deleteTask(task, confirmed = false) {
            if (!confirmed) {
              if (!confirm('Are you sure?')) {
                return;
              }
            }

            const response = await fetch(`/api/piero/tasks/${task.id}`, {
              method: 'DELETE'
            });
            const index = this.tasks.findIndex(t => t.id === task.id);
            if (index === -1) {
              return;
            }
            this.tasks.splice(index, 1);
            this.hasDone = this.tasks.filter(t => t.done).length > 0;
          },
          async updateTaskStatus(task) {
            const response = await fetch(`/api/piero/tasks/${task.id}`, {
              method: 'PUT',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({
                name: task.name,
                done: !task.done
              })
            });
            // Update the UI
            task.done = !task.done;
            this.hasDone = this.tasks.filter(t => t.done).length > 0;
          }
<<<<<<< HEAD
        }

        function generateUniqueId() {
          // Implement your own unique ID generation logic
          // You can use libraries like uuid or generate a timestamp-based ID
          // For simplicity, let's use a timestamp-based ID here
          return Date.now().toString();
        }

        taskForm.addEventListener("submit", handleFormSubmit);

      </script>
=======
        };
      }
    </script>
    <script src="//unpkg.com/alpinejs"></script>
>>>>>>> c8d38012bb588121bc50bd9602ea1027edcb8d29

  </body>

</html>